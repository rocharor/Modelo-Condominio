<?php
    namespace Rocharor\Condominio\Modulos\Controllers;

    use Rocharor\Condominio\Sistema\Controller;
    use Rocharor\Condominio\Sistema\Sessao;

    class Adm extends Controller{

        public function indexAction($link){
            $msg = '';
            if(isset($_POST['metodo'])){
                $metodo = $_POST['metodo'];
                $dados = $_POST;
                unset($dados['metodo']);

                $geral = new GeralModel;
                $ret = $geral->$metodo($dados);
                if($ret){
                    $msg = 'Inserido com sucesso';
                }
            }

            if(!isset($_SESSION['logado']) && Sessao::pegaSessao('logado') == 0){
                $variaveis = ['pagina_main' => 'adm/login.html',
                              'link' => $link,
                              'msg' => '',
                              'anuncio'=>false];
            }else{
                $variaveis = ['pagina_main' => 'adm/adm.html',
                              'link' => $link,
                              'msg' => $msg,
                              'anuncio'=>false];
            }

            $this->view('main',$variaveis);
        }

        public function loginAction($link){
            $user = $_POST['user_login'];
            $pass = $_POST['senha_login'];
            //$usuarios = new UsuariosModel;
            //$listagem = $usuarios->listar();

            if($user == 'admin' && $pass == 'admin'){
                $variaveis = ['pagina_main' => 'adm/adm.html',
                          'link' => $link,
                          'msg' => '',
                          'anuncio'=>false];

                $this->view('main',$variaveis);
            }else{
                $variaveis = ['pagina_main' => 'adm/login.html',
                          'link' => $link,
                          'msg' => 'UsuÃ¡rio ou senha invalidos',
                          'anuncio'=>false];

                $this->view('main',$variaveis);
            }

        }
    }
